<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½é—®ç­”Agent - AIåŠ©æ‰‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Noto Sans SC', sans-serif;
        }
        .code-font {
            font-family: 'JetBrains Mono', monospace;
        }
        .bg-gradient-tech {
            background: linear-gradient(135deg, #0B1426 0%, #1a2332 50%, #0B1426 100%);
        }
        .text-glow {
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        .card-glow {
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.1);
        }
        .typing-indicator {
            opacity: 0;
            animation: typing 2s infinite;
        }
        @keyframes typing {
            0%, 60%, 100% { opacity: 0; }
            30% { opacity: 1; }
        }
        .message-enter {
            animation: messageSlideIn 0.3s ease-out;
        }
        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .particle-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .sidebar-nav {
            backdrop-filter: blur(10px);
            background: rgba(11, 20, 38, 0.8);
        }
        .chat-container {
            backdrop-filter: blur(10px);
            background: rgba(26, 35, 50, 0.6);
        }
        .input-area {
            backdrop-filter: blur(15px);
            background: rgba(11, 20, 38, 0.9);
        }
        .nav-item {
            transition: all 0.3s ease;
        }
        .nav-item:hover {
            transform: translateX(5px);
            background: rgba(0, 212, 255, 0.1);
        }
        .nav-item.active {
            background: rgba(0, 212, 255, 0.2);
            border-left: 3px solid #00D4FF;
        }
        .feedback-btn {
            transition: all 0.2s ease;
        }
        .feedback-btn:hover {
            transform: scale(1.1);
        }
        .status-indicator {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
	/* Markdown æ ·å¼ */
	.markdown-content {
	    line-height: 1.6;
	    word-wrap: break-word;
	}

	.markdown-content h1,
	.markdown-content h2,
	.markdown-content h3,
	.markdown-content h4,
	.markdown-content h5,
	.markdown-content h6 {
	    margin-top: 1.5em;
	    margin-bottom: 0.5em;
	    font-weight: 600;
	    line-height: 1.25;
	}

	.markdown-content h1 { font-size: 1.5em; }
	.markdown-content h2 { font-size: 1.25em; }
	.markdown-content h3 { font-size: 1.125em; }
	.markdown-content h4 { font-size: 1em; }
	.markdown-content h5 { font-size: 0.875em; }
	.markdown-content h6 { font-size: 0.85em; }

	.markdown-content p {
	    margin-top: 0;
	    margin-bottom: 1em;
	}

	.markdown-content a {
	    color: #00D4FF;
	    text-decoration: none;
	}

	.markdown-content a:hover {
	    text-decoration: underline;
	}

	.markdown-content ul,
	.markdown-content ol {
	    margin-top: 0;
	    margin-bottom: 1em;
	    padding-left: 2em;
	}

	.markdown-content li {
	    margin-bottom: 0.25em;
	}

	.markdown-content blockquote {
	    margin: 0;
	    padding: 0 1em;
	    color: #94a3b8;
	    border-left: 0.25em solid #475569;
	}

	.markdown-content pre {
	    background-color: #0f172a;
	    border-radius: 0.375rem;
	    padding: 1em;
 	    margin: 1em 0;
	    overflow-x: auto;
	}

	.markdown-content code {
	    font-family: 'JetBrains Mono', monospace;
	    font-size: 0.875em;
	}

	.markdown-content .inline-code {
	    background-color: rgba(30, 41, 59, 0.5);
	    color: #00D4FF;
	    padding: 0.2em 0.4em;
	    border-radius: 0.25rem;
	    font-size: 0.9em;
	}

	.markdown-content table {
	    border-collapse: collapse;
	    width: 100%;
	    margin: 1em 0;
	}

	.markdown-content th,
	.markdown-content td {
	    border: 1px solid #475569;
	    padding: 0.5em 0.75em;
	    text-align: left;
	}

	.markdown-content th {
	    background-color: #1e293b;
	    font-weight: 600;
	}

	.markdown-content tr:nth-child(even) {
	    background-color: rgba(30, 41, 59, 0.3);
	}

	/* æ•°å­¦å…¬å¼æ ·å¼ */
	.markdown-content .math-block {
	    margin: 1.5em 0;
	    text-align: center;
	    overflow-x: auto;
	    overflow-y: hidden;
	}

	.markdown-content .katex {
	    font-size: 1.1em;
	}
	
	/* æ°´å¹³çº¿ */
	.markdown-content hr {
	    height: 1px;
	    background-color: #475569;
	    border: none;
	    margin: 1.5em 0;
	}
    </style>
</head>
<body class="bg-gradient-tech text-white min-h-screen overflow-hidden">
    <!-- ç²’å­èƒŒæ™¯ -->
    <div id="particle-bg" class="particle-bg"></div>
    
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-black bg-opacity-20 backdrop-blur-md border-b border-gray-700">
        <div class="flex items-center justify-between px-6 py-4">
            <div class="flex items-center space-x-4">
                <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-cyan-400 rounded-lg flex items-center justify-center">
                    <span class="text-white font-bold text-sm">AI</span>
                </div>
                <h1 class="text-xl font-bold text-glow">æ™ºèƒ½é—®ç­”Agent</h1>
            </div>
            <div class="flex items-center space-x-6">
                <a href="index.html" class="nav-link text-cyan-400 border-b-2 border-cyan-400 pb-1">é—®ç­”</a>
                <a href="knowledge.html" class="nav-link text-gray-300 hover:text-white transition-colors">çŸ¥è¯†åº“</a>
                <a href="analytics.html" class="nav-link text-gray-300 hover:text-white transition-colors">åˆ†æ</a>
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 bg-green-400 rounded-full status-indicator"></div>
                    <span class="text-sm text-gray-300">åœ¨çº¿</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»å®¹å™¨ -->
    <div class="flex h-screen pt-16">
        <!-- å·¦ä¾§è¾¹æ  -->
        <div class="w-64 sidebar-nav border-r border-gray-700 p-4 overflow-y-auto">
            <div class="mb-6">
                <h3 class="text-sm font-semibold text-gray-400 mb-3">å¿«é€ŸåŠŸèƒ½</h3>
                <div class="space-y-2">
                    <button class="nav-item w-full text-left px-3 py-2 rounded text-sm text-gray-300" onclick="showApiConfig()">
                        ğŸ”§ APIé…ç½®
                    </button>
                    <button class="nav-item w-full text-left px-3 py-2 rounded text-sm text-gray-300" onclick="clearChat()">
                        ğŸ—‘ï¸ æ¸…ç©ºå¯¹è¯
                    </button>
                    <button class="nav-item w-full text-left px-3 py-2 rounded text-sm text-gray-300" onclick="exportChat()">
                        ğŸ’¾ å¯¼å‡ºå¯¹è¯
                    </button>
                    <button class="nav-item w-full text-left px-3 py-2 rounded text-sm text-gray-300" onclick="showSettings()">
                        âš™ï¸ è®¾ç½®
                    </button>
                </div>
            </div>
            
            <div class="mb-6">
                <h3 class="text-sm font-semibold text-gray-400 mb-3">å†å²å¯¹è¯</h3>
                <div class="space-y-2" id="history-list">
                    <div class="nav-item px-3 py-2 rounded text-sm text-gray-300 cursor-pointer" onclick="loadHistory('1')">
                        <div class="font-medium">å…³äºæœºå™¨å­¦ä¹ çš„è®¨è®º</div>
                        <div class="text-xs text-gray-500 mt-1">2025-12-23 14:30</div>
                    </div>
                    <div class="nav-item px-3 py-2 rounded text-sm text-gray-300 cursor-pointer" onclick="loadHistory('2')">
                        <div class="font-medium">æ·±åº¦å­¦ä¹ åŸç†é—®ç­”</div>
                        <div class="text-xs text-gray-500 mt-1">2025-12-23 13:15</div>
                    </div>
                    <div class="nav-item px-3 py-2 rounded text-sm text-gray-300 cursor-pointer" onclick="loadHistory('3')">
                        <div class="font-medium">AIæŠ€æœ¯å‘å±•å†å²</div>
                        <div class="text-xs text-gray-500 mt-1">2025-12-23 11:20</div>
                    </div>
                </div>
            </div>

            <!-- ç»Ÿè®¡ä¿¡æ¯ -->
            <div class="bg-gray-800 bg-opacity-50 rounded-lg p-4">
                <h3 class="text-sm font-semibold text-gray-400 mb-3">ä»Šæ—¥ç»Ÿè®¡</h3>
                <div class="space-y-2 text-xs">
                    <div class="flex justify-between">
                        <span class="text-gray-500">é—®ç­”æ¬¡æ•°:</span>
                        <span class="text-cyan-400">47</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-500">å¹³å‡å“åº”:</span>
                        <span class="text-cyan-400">1.2s</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-500">æ»¡æ„åº¦:</span>
                        <span class="text-cyan-400">94%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸»èŠå¤©åŒºåŸŸ -->
        <div class="flex-1 flex flex-col">
            <!-- èŠå¤©å†…å®¹åŒºåŸŸ -->
            <div class="flex-1 chat-container overflow-y-auto p-6" id="chat-messages">
                <!-- æ¬¢è¿æ¶ˆæ¯ -->
                <div class="message-enter mb-6">
                    <div class="flex items-start space-x-3">
                        <img src="resources/ai-avatar.png" alt="AI" class="w-10 h-10 rounded-full">
                        <div class="flex-1">
                            <div class="bg-gray-800 bg-opacity-60 rounded-lg p-4 max-w-3xl">
                                <div class="text-sm text-gray-300 mb-2">AIåŠ©æ‰‹</div>
                                <div class="text-white">
                                    ä½ å¥½ï¼æˆ‘æ˜¯æ™ºèƒ½é—®ç­”Agentï¼Œä¸€ä¸ªå…·å¤‡è‡ªä¸»å­¦ä¹ èƒ½åŠ›çš„AIåŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®åŠ©ä½ è§£ç­”å„ç§é—®é¢˜ï¼Œä»æ—¥å¸¸çŸ¥è¯†åˆ°ä¸“ä¸šæŠ€æœ¯ï¼Œä»å­¦ä¹ æ–¹æ³•åˆ°åˆ›æ„æ€è€ƒã€‚
                                    <br><br>
                                    æˆ‘çš„ç‰¹è‰²åŠŸèƒ½åŒ…æ‹¬ï¼š
                                    <br>â€¢ ğŸ§  æ™ºèƒ½è¯­ä¹‰ç†è§£å’Œæ¨ç†
                                    <br>â€¢ ğŸ“š è‡ªä¸»å­¦ä¹ å’ŒçŸ¥è¯†ç§¯ç´¯
                                    <br>â€¢ ğŸ’¡ å¤šè½®å¯¹è¯å’Œä¸Šä¸‹æ–‡è®°å¿†
                                    <br>â€¢ ğŸ“Š ä¸ªæ€§åŒ–å›ç­”å’ŒæŒç»­ä¼˜åŒ–
                                    <br><br>
                                    æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿè¯·éšæ—¶æé—®ï¼
                                </div>
                                <div class="flex items-center space-x-4 mt-3 text-xs text-gray-500">
                                    <span>åˆšåˆš</span>
                                    <button class="feedback-btn text-green-400 hover:text-green-300" onclick="agent.likeMessage('welcome')">ğŸ‘</button>
                                    <button class="feedback-btn text-red-400 hover:text-red-300" onclick="agent.dislikeMessage('welcome')">ğŸ‘</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è¾“å…¥åŒºåŸŸ -->
            <div class="input-area border-t border-gray-700 p-4">
                <div class="flex items-end space-x-4">
                    <div class="flex-1">
                        <textarea 
                            id="message-input" 
                            placeholder="è¾“å…¥ä½ çš„é—®é¢˜... (Ctrl+Enterå‘é€)" 
                            class="w-full bg-gray-800 bg-opacity-60 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 resize-none focus:outline-none focus:border-cyan-400 focus:ring-1 focus:ring-cyan-400"
                            rows="3"
                        ></textarea>
                    </div>
                    <div class="flex flex-col space-y-2">
                        <button 
                            onclick="sendMessage()" 
                            class="bg-gradient-to-r from-blue-500 to-cyan-400 hover:from-blue-600 hover:to-cyan-500 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 card-glow"
                        >
                            å‘é€
                        </button>
                        <button 
                            onclick="toggleVoice()" 
                            class="bg-gray-700 hover:bg-gray-600 text-white px-6 py-2 rounded-lg text-sm transition-colors"
                        >
                            ğŸ¤ è¯­éŸ³
                        </button>
                    </div>
                </div>
                
                <!-- å¿«æ·é—®é¢˜ -->
                <div class="flex flex-wrap gap-2 mt-4">
                    <button class="bg-gray-700 hover:bg-gray-600 text-xs px-3 py-1 rounded-full transition-colors" onclick="quickQuestion('ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ')">
                        ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ
                    </button>
                    <button class="bg-gray-700 hover:bg-gray-600 text-xs px-3 py-1 rounded-full transition-colors" onclick="quickQuestion('å¦‚ä½•å­¦ä¹ æœºå™¨å­¦ä¹ ï¼Ÿ')">
                        å¦‚ä½•å­¦ä¹ æœºå™¨å­¦ä¹ ï¼Ÿ
                    </button>
                    <button class="bg-gray-700 hover:bg-gray-600 text-xs px-3 py-1 rounded-full transition-colors" onclick="quickQuestion('æ¨èä¸€äº›AIå­¦ä¹ èµ„æº')">
                        æ¨èAIå­¦ä¹ èµ„æº
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- APIé…ç½®å¼¹çª— -->
    <div id="api-config-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-gray-800 rounded-lg p-6 w-96 max-w-90vw">
            <h3 class="text-lg font-semibold mb-4">DeepSeek APIé…ç½®</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">AIæœåŠ¡æä¾›å•†</label>
                    <select class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white" id="api-provider">
                        <option value="deepseek" selected>DeepSeek</option>
                        <option value="openai">OpenAI</option>
                        <option value="local">æœ¬åœ°æ¨¡å‹</option>
                    </select>
                </div>
                <div id="api-key-group">
                    <label class="block text-sm font-medium mb-2">APIå¯†é’¥</label>
                    <div class="relative">
                        <input type="password" id="api-key-input" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white pr-10" placeholder="sk-xxxxxxxxxxxxxxxxxxxxxxxx">
                        <button onclick="toggleApiKeyVisibility()" class="absolute right-2 top-2 text-gray-400 hover:text-white" type="button">
                            ğŸ‘ï¸
                        </button>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">
                        â€¢ è·å–DeepSeek APIå¯†é’¥: <a href="https://platform.deepseek.com/api_keys" target="_blank" class="text-cyan-400 hover:underline">DeepSeekå¹³å°</a>
                        <br>â€¢ å¯†é’¥ä»…ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œç»å¯¹å®‰å…¨
                    </p>
                </div>
                <div id="model-group">
                    <label class="block text-sm font-medium mb-2">æ¨¡å‹é€‰æ‹©</label>
                    <select class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white" id="model-select">
                        <option value="deepseek-chat" selected>DeepSeek Chat (æ¨è)</option>
                        <option value="deepseek-coder">DeepSeek Coder (ç¼–ç¨‹ä¸“ç”¨)</option>
                    </select>
                </div>
                <button onclick="testApiConnection()" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded transition-colors flex items-center justify-center">
                    <span id="test-btn-text">æµ‹è¯•è¿æ¥</span>
                    <span id="test-loading" class="hidden ml-2">ğŸ”„</span>
                </button>
                <div id="test-result" class="hidden p-3 rounded text-sm"></div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeApiConfig()" class="bg-gray-600 hover:bg-gray-500 px-4 py-2 rounded transition-colors">å–æ¶ˆ</button>
                <button onclick="saveApiConfig()" class="bg-green-500 hover:bg-green-600 px-4 py-2 rounded transition-colors">ä¿å­˜é…ç½®</button>
            </div>
        </div>
    </div>

    <!-- è®¾ç½®å¼¹çª— -->
    <div id="settings-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-gray-800 rounded-lg p-6 w-96 max-w-90vw">
            <h3 class="text-lg font-semibold mb-4">è®¾ç½®</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">AIå›ç­”é€Ÿåº¦</label>
                    <input type="range" min="1" max="10" value="5" class="w-full" id="typing-speed">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>å¿«é€Ÿ</span>
                        <span>æ…¢é€Ÿ</span>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">è‡ªåŠ¨ä¿å­˜å¯¹è¯</label>
                    <input type="checkbox" checked class="mr-2" id="auto-save">
                    <span class="text-sm">å¯ç”¨è‡ªåŠ¨ä¿å­˜</span>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">æµå¼å“åº”</label>
                    <input type="checkbox" checked class="mr-2" id="enable-streaming">
                    <span class="text-sm">å¯ç”¨å®æ—¶æµå¼å“åº”</span>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">ä¸»é¢˜</label>
                    <select class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white" id="theme-select">
                        <option value="dark">æ·±è‰²ä¸»é¢˜</option>
                        <option value="light">æµ…è‰²ä¸»é¢˜</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeSettings()" class="bg-gray-600 hover:bg-gray-500 px-4 py-2 rounded transition-colors">å–æ¶ˆ</button>
                <button onclick="saveSettings()" class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded transition-colors">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- è„šæœ¬å¼•å…¥ -->
    <script src="markdown-renderer.js"></script>
    <script src="api.js"></script>
    <script src="config.js"></script>
    <script src="main.js"></script>
</body>
</html>